---
title: PDFç›®å½•ç”Ÿæˆ
date: 2023-2-13 23:45:55
categories: [æ•™ç¨‹]
tags: å·¥å…· è‡ªåŠ¨åŒ–

---

## pdf.tocgenä½¿ç”¨

å·¥å…·é“¾ï¼š

pdfxmetaï¼ˆæå–å…ƒæ•°æ®ï¼‰+pdftocgenï¼ˆç”Ÿæˆç›®æ ‡è¡¨ï¼‰+pdftocioï¼ˆæ·»åŠ ç›®å½•ï¼‰ã€‚

![image-20230213215046883](https://picbed.olimi.icu//img/image-20230213215046883.png)

æµ‹è¯•æ¡ˆä¾‹ï¼š

1. pdfxmetaæå–å…ƒæ•°æ®

   ```bash
   pdfxmeta.exe -p 1 -a 1 .\30å ‚è¯åˆ¸æŠ•èµ„é€šè¯†è¯¾_æ— ç›®å½•ç‰ˆ.pdf "è¯åˆ¸æŠ•èµ„åŸºç¡€"
   pdfxmeta -p 1 -a 2 30å ‚è¯åˆ¸æŠ•èµ„é€šè¯†è¯¾_æ— ç›®å½•ç‰ˆ.pdf "â¼€ã€äº†è§£å¹¶æŒæ¡è¯åˆ¸æŠ•èµ„è¿™â»”è‰ºæœ¯"
   pdfxmeta -p 1 -a 3 30å ‚è¯åˆ¸æŠ•èµ„é€šè¯†è¯¾_æ— ç›®å½•ç‰ˆ.pdf "æŠ•èµ„è€…é€‚åº”æ€§"
   ```

   æ‹·è´è¾“å‡ºã€‚å¦‚ä¸‹ï¼š

   ```toml
   [[heading]]
   # ç¬¬â¼€è®² è¯åˆ¸æŠ•èµ„åŸºç¡€
   level = 1
   greedy = true
   font.name = "Unnamed-T3"
   font.size = 24.000001907348633
   # font.size_tolerance = 1e-5
   # font.color = 0x24292e
   # font.superscript = false
   # font.italic = false
   # font.serif = false
   # font.monospace = false
   # font.bold = false
   # bbox.left = 50.5
   # bbox.top = 44.13671875
   # bbox.right = 271.6211242675781
   # bbox.bottom = 72.80078125
   # bbox.tolerance = 1e-5
   
   [[heading]]
   # â¼€ã€äº†è§£å¹¶æŒæ¡è¯åˆ¸æŠ•èµ„è¿™â»”è‰ºæœ¯ğŸ°
   level = 2
   greedy = true
   font.name = "Unnamed-T3"
   font.size = 18.000001907348633
   # font.size_tolerance = 1e-5
   # font.color = 0x24292e
   # font.superscript = false
   # font.italic = false
   # font.serif = false
   # font.monospace = false
   # font.bold = false
   # bbox.left = 50.5
   # bbox.top = 99.22750854492188
   # bbox.right = 338.5000305175781
   # bbox.bottom = 125.1911849975586
   # bbox.tolerance = 1e-5
   [[heading]]
   # ğŸ¼ æŠ•èµ„è€…é€‚åº”æ€§
   level = 3
   greedy = true
   font.name = "Unnamed-T3"
   font.size = 15.000000953674316
   # font.size_tolerance = 1e-5
   # font.color = 0x24292e
   # font.superscript = false
   # font.italic = false
   # font.serif = false
   # font.monospace = false
   # font.bold = false
   # bbox.left = 50.5
   # bbox.top = 145.73126220703125
   # bbox.right = 158.927734375
   # bbox.bottom = 164.37550354003906
   # bbox.tolerance = 1e-5
   ```

2. ä½¿ç”¨å…ƒæ•°æ®ï¼Œæ‰«æPDFè·å–ç›®å½•ä¿¡æ¯:

   ```bash
   # windowsç¼–ç é—®é¢˜ï¼Œpsç»ˆç«¯å†™æ³•
   $env:PYTHONUTF8=1 # CMDï¼šSet PYTHONUTF8=1
   
   # psç®¡é“å†™æ³•
   get-Content .\recipe.toml | pdftocgen.exe .\30å ‚è¯åˆ¸æŠ•èµ„é€šè¯†è¯¾_æ— ç›®å½•ç‰ˆ.pdf # CMDï¼špdftocgen 30å ‚è¯åˆ¸æŠ•èµ„é€šè¯†è¯¾_æ— ç›®å½•ç‰ˆ.pdf < recipe.toml
   # ç›´æ¥ç”¨ç®¡é“è¾“å‡ºæ–‡ä»¶ç¼–ç ä¸ºutf16ï¼Œç”¨ä¸äº†ï¼Œè¿˜æ˜¯è¾“å‡ºåˆ°ç»ˆç«¯è‡ªå·±æ‹·è´
   ```

   æ‹·è´è¾“å‡ºï¼Œæ•ˆæœï¼š

   ```txt
   "ç¬¬â¼€è®² è¯åˆ¸æŠ•èµ„åŸºç¡€" 1
       "â¼€ã€äº†è§£å¹¶æŒæ¡è¯åˆ¸æŠ•èµ„è¿™â»”è‰ºæœ¯ğŸ°" 1
           "ğŸ¼ æŠ•èµ„è€…é€‚åº”æ€§" 1
           "ğŸ¼ è¿½æ¶¨æ€è·Œä¸ºå“ªèˆ¬" 1
           "ğŸ¼ å¦‚ä½•åŸ¹å…»â¾¦èå—…è§‰" 1
       "â¼†ã€è‚¡ç¥¨æŠ•èµ„ABCğŸ°" 1
           "ğŸ„ ä¸­å›½è‚¡å¸‚ä¹±è±¡" 1
           "ğŸ„ æˆ˜å‰æ€»åŠ¨å‘˜" 2
           "ğŸ„ ä¸­å›½è‚¡ç¥¨å¸‚åœºçš„ç‰¹æ®Šæ€§" 3
           "ğŸ„ ä¸­å›½è‚¡å¸‚çš„è¶…å‡¡é­…â¼’" 3
           "ğŸ„ é€‰è‚¡ABCâ¸ºâ¾¼â¼¿æ•™ä½ åœ¨è‚¡å¸‚æ·˜â¾¦" 3
       "ä¸‰ã€åŸºâ¾¦æŠ•èµ„ABCğŸ°" 3
           "ğŸ”” åŸºâ¾¦â¾¼â¼¿å…·å¤‡ä»€ä¹ˆç‰¹è´¨" 3
           "ğŸ”” æˆ‘å›½åŸºâº ä¸ºä½•äºé’±" 3
           "ğŸ”” åŸºâº å’Œè‚¡âº çš„æŠ•èµ„â½è¾ƒå’Œå¸‚åœºè®¤çŸ¥" 4
           "ğŸ”” å¦‚ä½•â½¤ä¸“ä¸šçš„åŸºâ¾¦ç»ç†å¸®ä½ ç†è´¢" 4
   "ç¬¬â¼†è®² è¯åˆ¸æŠ•èµ„ç†è®º" 4
       "â¼€ã€èµ„æœ¬èµ„äº§å®šä»·æ¨¡å‹ğŸ‘" 4
           "ğŸ¯è¯åˆ¸æŠ•èµ„ç†è®ºå¯¹ä¸­å›½è‚¡ç¥¨å¸‚åœºæœ‰ä»€ä¹ˆå€Ÿé‰´æ„ä¹‰" 4
           "ğŸ¯ èµ„æœ¬èµ„äº§å®šä»·æ¨¡å‹çš„å‡è®¾æ¡ä»¶" 4
           "ğŸ¯èµ„æœ¬å¸‚åœºçº¿" 5
           "ğŸ¯èµ„æœ¬èµ„äº§å®šä»·æ¨¡å‹åœ¨å®é™…æŠ•èµ„ä¸­çš„åº”â½¤Î²ç­–ç•¥" 6
           "ğŸ¯èµ„æœ¬èµ„äº§å®šä»·æ¨¡å‹çš„å±€é™æ€§" 6
       "â¼†ã€æœ‰æ•ˆå¸‚åœºå‡è¯´ğŸ‘" 7
           "ğŸ‘æœ‰æ•ˆå¸‚åœºå‡è¯´å’Œæœ‰æ•ˆå¸‚åœºç±»å‹" 7
           "ğŸ‘æœ‰æ•ˆå¸‚åœºä¸­çš„æŠ•èµ„ç­–ç•¥åˆ†æ" 7
           "ğŸ‘æœ‰æ•ˆå¸‚åœºç†è®ºçš„å¯ç¤º" 8
       "ä¸‰ã€èµ„äº§é…ç½®ç­–ç•¥ğŸ‘" 8
           "ğŸ¦èµ„äº§é…ç½®æ¦‚è¿°" 8
           "ğŸ¦å¸¸â»…çš„æˆ˜ç•¥èµ„äº§é…ç½®çš„æ‰§â¾â½…å¼" 8
           "ğŸ¦æˆ˜æœ¯èµ„äº§é…ç½®" 9
           "ğŸ¦åŠ¨æ€èµ„äº§é…ç½®" 9
           ...
   ```

3. å¯¼å…¥ç›®å½•åˆ°PDF

   ```bash
   pdftocio -t toc.txt -o out.pdf 30å ‚è¯åˆ¸æŠ•èµ„é€šè¯†è¯¾_æ— ç›®å½•ç‰ˆ.pdf
   ```

## é—®é¢˜

ç¼–ç é—®é¢˜æ³¨æ„ä¸€ä¸‹ï¼Œéƒ½ç”¨utf8ã€‚åœ¨å‰é¢æ³¨æ„åˆ°äº†ã€‚çœ‹åˆ°æœ‰è§£å†³è¿™ä¸ªé—®é¢˜çš„PRï¼Œä½†æ˜¯å¥½åƒæ²¡mergeã€‚

### æ ‡é¢˜æ–‡å­—æ˜¯ä¹±ç 

å¦å¤–ï¼Œåœ¨ç¬¬ä¸€ä¸ªRecipeçš„æŸ¥æ‰¾ï¼Œå‘ç°æˆ‘çš„PDFæœ‰äº›å­—æ‰¾ä¸åˆ°ã€‚ä»PDFå¤åˆ¶æ–‡å­—å‡ºæ¥ï¼Œä¹Ÿæ˜¯ç°å®ä¹±ç ã€‚ç›¸å½“äºè¿™éƒ¨åˆ†å­—èƒ½çœ‹åˆ°ï¼Œä½†æ˜¯æ‰«æPDFæ—¶è¯†åˆ«ä¸å‡ºæ¥çš„ã€‚è¿™ä¹Ÿå°±å¯¼è‡´pdfxmetaæ‰«æå…ƒæ•°æ®æ—¶æ²¡åŠæ³•ç”¨æœ€åçš„æœç´¢çš„æ–‡å­—ã€‚

**è§£å†³æ–¹æ¡ˆï¼š**

1. æ‰¾æ ‡é¢˜ä¸­å¸¦è‹±æ–‡çš„æ–‡å­—ï¼Œæœç´¢è¿™ä¸ªã€‚è‹±æ–‡è‚¯å®šä¸ä¼šä¹±ç ã€‚
2. ä¸ä½¿ç”¨æœç´¢æ–‡å­—åŠŸèƒ½ï¼Œå»é™¤æœ€åä¸€ä¸ªå‚æ•°ï¼Œç›´æ¥`pdfxmete -p 1 -a 1 xx.pdf`ã€‚ç„¶åæ…¢æ…¢æ‰¾æ ‡é¢˜é‚£æ®µã€‚ä¸€èˆ¬æ¥è¯´æ ‡é¢˜åœ¨æœ€å‰é¢ï¼Œå°±æ˜¯æœ€å‰é¢é‚£æ®µã€‚

å½“ç„¶äº†ï¼Œå‰é¢pdfmetaæ‰«ä¸åˆ°ï¼Œåé¢ç”Ÿæˆç›®å½•ä¹Ÿæ‰«ä¸åˆ°ï¼Œä¹Ÿæ˜¯ä¹±ç ã€‚è¿™ä¸ªæš‚æ—¶å°±åªèƒ½æ‰‹è¾“äº†ã€‚

